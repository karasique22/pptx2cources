<style>
	body {
		font-family: sans-serif;
	}

	#submit {
		margin: 10px auto;
		background-color: pink;
		border: 1px solid black;
		border-radius: 4px;
	}
</style>

<h2 style="text-align: center">pptx2curces)</h2>
<input id="load" type="file" accept=".pptx" />
<button id="submit" type="submit">АНУС</button>

<script>
	const submitButton = document.querySelector("#submit");
	const load = document.querySelector("#load");

	submitButton.addEventListener("click", e => {
		const file = load.files[0];
		const reader = new FileReader();

		// Read file as ArrayBuffer to preserve binary integrity
		reader.onload = () => {
			const content = reader.result;

			// Send ArrayBuffer content directly to plugin without modification
			parent.postMessage(
				{
					pluginMessage: {
						type: "file",
						data: content,
						name: file.name,
					},
				},
				"*"
			);
		};
		reader.readAsArrayBuffer(file); // Ensure ArrayBuffer is used
	});
</script>
